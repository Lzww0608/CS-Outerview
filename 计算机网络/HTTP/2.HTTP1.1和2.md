HTTP/1.1 与 HTTP/2 是超文本传输协议（HTTP）的两个主要版本，后者旨在解决前者的性能瓶颈。HTTP/2 于 2015 年正式发布，通过引入多项关键技术，显著提升了网页加载速度和网络资源利用率。

以下是两者之间的核心区别：



### 1. 多路复用 (Multiplexing) vs. 队头阻塞 (Head-of-Line Blocking)

- **HTTP/1.1**: 存在“队头阻塞”问题。浏览器客户端通常对同一域名下的并发请求数量有限制（例如 6 个）。在一个 TCP 连接上，请求和响应必须按顺序进行，即发送一个请求后，必须等待其响应完全返回，才能发送下一个请求。尽管 HTTP/1.1 引入了“管道化”（Pipelining）技术，允许连续发送多个请求而无需等待响应，但这并未根本解决问题，因为服务器必须按接收顺序返回响应。如果第一个响应耗时很长，后续的响应即便已处理完毕，也必须排队等待，这就是队头阻塞。
- **HTTP/2**: 引入了**多路复用**机制，这是其最重要的改进。在单个 TCP 连接上，HTTP/2 可以同时处理多个请求和响应。每个请求和响应都被分解成更小的、独立的帧（Frame），并赋予唯一的流 ID（Stream ID）。这些帧可以交错发送，接收端再根据流 ID 将它们重新组装。这样，一个耗时较长的请求不会阻塞其他请求的处理，从而彻底解决了队头阻塞问题，极大地提高了并发性能。

| 特性         | HTTP/1.1                         | HTTP/2                            |
| ------------ | -------------------------------- | --------------------------------- |
| **并发模型** | 顺序处理和管道化                 | 多路复用                          |
| **连接数**   | 需要为并发请求建立多个 TCP 连接  | 单个 TCP 连接即可处理多个并发请求 |
| **性能瓶颈** | 队头阻塞 (Head-of-Line Blocking) | 解决了应用层的队头阻塞            |



### 2. 二进制分帧 (Binary Framing)

- **HTTP/1.1**: 是一个基于文本的协议。其报文（如请求头、响应头）是人类可读的纯文本，以换行符分隔。这使得协议的解析相对简单，但也带来了稳健性不足和解析效率较低的问题。
- **HTTP/2**: 则是一个二进制协议。所有传输的信息都被分割为更小的消息和帧，并采用二进制格式编码。这使得协议的解析更为高效和健壮，减少了数据传输的开销，并且不易出错。这也是实现多路复用的技术基础。



### 3. 头部压缩 (Header Compression)

- **HTTP/1.1**: 请求和响应的头部信息（Headers）通常包含大量重复数据（如 `User-Agent`, `Accept` 等），并且每次请求都必须携带完整的头部，这会消耗不必要的网络带宽，尤其是在请求数量多或头部信息庞大的情况下。
- **HTTP/2**: 使用 **HPACK** 算法对头部信息进行压缩，从而显著减少了网络开销。HPACK 的工作原理如下：
  - **动态维护头部表**: 客户端和服务器共同维护一个包含之前传输过的头部字段的索引列表。
  - **增量更新**: 对于重复的头部字段，只需发送一个短小的索引号即可。
  - **霍夫曼编码**: 对新的或不常见的头部字段使用霍夫曼编码进行压缩。



### 4. 服务器推送 (Server Push)

- **HTTP/1.1**: 客户端必须先请求一个 HTML 文件，解析后才能发现页面依赖的其他资源（如 CSS、JavaScript、图片等），然后再逐一发起请求。这种“请求-响应”模式存在延迟。
- **HTTP/2**: 引入了**服务器推送**功能。服务器可以在客户端请求之前，主动将它认为客户端即将需要的资源“推送”过去。例如，当客户端请求一个 HTML 页面时，服务器可以同时将该页面所需的 CSS 和 JavaScript 文件一并发送给客户端，从而减少了客户端的等待时间和请求次数，加快了页面加载速度。



### 总结

| 特性         | HTTP/1.1      | HTTP/2        | 优势                     |
| ------------ | ------------- | ------------- | ------------------------ |
| **传输格式** | 文本协议      | 二进制协议    | 解析高效、健壮           |
| **并发处理** | 队头阻塞      | 多路复用      | 高并发、无阻塞           |
| **头部压缩** | 无压缩        | HPACK 压缩    | 减少网络开销             |
| **资源请求** | 客户端请求    | 服务器可推送  | 减少请求延迟             |
| **连接管理** | 多个 TCP 连接 | 单个 TCP 连接 | 降低服务器负载和网络拥塞 |

总而言之，HTTP/2 通过引入多路复用、二进制分帧、头部压缩和服务器推送等核心功能，从根本上解决了 HTTP/1.1 的性能瓶颈，使得现代网页的加载更快、效率更高，网络资源利用也更加充分。